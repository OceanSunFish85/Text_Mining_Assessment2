way file excel file environment firewall environment java j2ee servlets jboss principle part solution common oh common apache net apache jakarta client ftp client filezilla ftp server help step first step create instance ftpclient use login connect login ftp server client ftpclient client client ftpclient client connect host client pas user pas need directory file life client changeworkingdirectory remotedirectory client ftp client way stream input stream file ftp server inputstream client retrievefilestream filename use incantation magic incantation header http header response browser window document renderer response setheader content type application x download response setheader content disposition attachment filename filename copy next copy file input stream ftp server output stream client byte byte new byte int bytesread outputstream response getoutputstream bytesread buffer buffer length buffer bytesread flush tidy server ftp server closing connection output close output stream client client disconnect