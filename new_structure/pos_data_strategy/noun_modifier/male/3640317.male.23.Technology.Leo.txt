message count message queue admin local admin api mqmgmtgetinfo api version microsoft version net c net invoke c write c call possibility faster possibility runtime data type mismatch invoke call need file mqrt h mqrt lib file system net vc net system class vc class library project ide net ide add mqrt dependency external dependency project msmqapilib h msmqapilib cpp file code function body machine name machine remote machine machine local machine eg buddha queue name queue queue prefix eg queue o direct o buddha msmqtriggersnotifications private msmqtriggersnotifications use net use function palbiswas msmq msmqapilib palbiswas new palbiswas msmq msmqapilib count mqlib getmessagecount buddha queue o direct o buddha msmqtriggersnotifications private msmqtriggersnotifications getmessagecount machine queue const wchar_t ptrtostringchars machine const wchar_t __pin q ptrtostringchars mqpropvariant propid mqpropvariant propvar hresult propstatus dword cprop cprop propid cprop propid_mgmt_queue_message_count propvar cprop cprop mqmgmtprops mqprops cprop mqprops mqprops propid mqprops mqprops propvar mqprops propstatus hresult hr mqmgmtgetinfo q return hr return mqprops return mqprops nb ulval nb get api get message count ie active ie queue open queue