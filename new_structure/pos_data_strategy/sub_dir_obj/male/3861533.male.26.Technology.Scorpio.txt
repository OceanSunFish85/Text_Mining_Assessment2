hallvard vassbotn blog interface solution news way way function getimplementingobject const ainterface iinterface tobject const addbyte opcode dword ptr shortint opcode add dword ptr longint type padjustselfthunk tadjustselfthunk tadjustselfthunk record case addinstruction longint addbyte adjustmentbyte shortint end pinterfacemt tinterfacemt tinterfacemt record queryinterfacethunk end tinterfaceref pinterfacemt queryinterfacethunk padjustselfthunk result pointer ainterface result try queryinterfacethunk ainterface queryinterfacethunk case addinstruction addbyte inc pchar result queryinterfacethunk adjustmentbyte pchar result queryinterfacethunk adjustmentlong result end result end end method hallvard post hack fact iinterface implement method prologue code self pointer stack adjustment fit byte shortint longint size parent class check adjustment field case compiler interface method table imt instance shortint longint convention stack safecall register message register code cannot modify way function getimplementingobject const ainstance iunknown const aguid tguid const aimplclass tclass tobject var linterfaceentry pinterfaceentry result aimplclass nil ainstance begin exit end linterfaceentry aimplclass getinterfaceentry aguid linterfaceentry begin linterfaceentry ioffset result integer ainstance linterfaceentry end end blogger theme source code