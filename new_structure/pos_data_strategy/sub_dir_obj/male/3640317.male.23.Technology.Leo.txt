__pin message count message queue admin api mqmgmtgetinfo api net invoke call possibility runtime type invoke call need mqrt lib system net system class library project ide add mqrt dependency project msmqapilib cpp file code function body machine name machine machine eg buddha queue name queue queue prefix eg queue o buddha use function palbiswas msmq msmqapilib palbiswas msmq msmqapilib count mqlib getmessagecount buddha queue o buddha getmessagecount machine queue const wchar_t machine const wchar_t q mqpropvariant propvar hresult propstatus dword cprop cprop propid_mgmt_queue_message_count propvar cprop cprop cprop propstatus hresult hr mqmgmtgetinfo q return nb get message count ie