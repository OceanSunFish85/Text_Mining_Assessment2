get message count message queue using msmq local admin api mqmgmtgetinfo api fully supported microsoft versions msmq call api c net directly p invoke write c managed wrapper call c net preferred second approch much faster possibility runtime data type mismatches p invoke call api need two files mq h mqrt lib files system vci e vc net installed system start new vc class library project msmqapilib net ide add mqrt lib external dependency project include mq h msmqapilib cpp file embed following code function body machine name remote machine null local machine eg buddha queue formated name queue queue prefix eg queue direct os buddha private msmqtriggersnotifications c net use function palbiswas msmq msmqapilib mqlib new palbiswas msmq msmqapilib long count mqlib getmessagecount buddha queue direct os buddha private msmqtriggersnotifications long msmqapilib getmessagecount string machine string queue const wchar_t __pin ptrtostringchars machine const wchar_t __pin q ptrtostringchars queue queuepropid propid mqpropvariant propvar hresult propstatus dword cprop propid cprop propid_mgmt_queue_message_count propvar cprop vt vt_null cprop mqmgmtprops mqprops mqprops cprop cprop mqprops apropid propid mqprops apropvar propvar mqprops astatus propstatus hresult hr mqmgmtgetinfo q failed hr return else return mqprops apropvar ulval nb using api get message count active ie open queues