great article sharepoint security smartpart webpart security hot days thats good thing developers point view security bitch sometimes code access security cas short wonderful useful concept developers need know keep cas mind want code run want learn cas general definitely recommend maxim karpovs article starter youre building sharepoint webparts youre asp net general cas really comes play scenarios code wont full trust means cant anything everything needs explicitly granted information cas combination sharepoint check article msdn youre using smartpart sharepoint also see previous post youre special scenario three involved parties sharepoint smartpart code lets say want create somewhat advanced user control show smartpart connects web service database youll run someproblems youve already tried using smartpart youll find following exception event log request permission type system net webpermission system versionculture neutral publickeytoken b77a5c561934e089 failed get exception default code thats executed bin folder sharepoint site uses reduced set permissions specified web config file e g wss_minimal wss_medium permission connect web service webpermission connect database granted default thats code wont run solve issue one would think lets add permission webpart remember using smartpart webpart adding permissions wont help us user control code still get needed permissions easy drastic solution deploy code global assembly cache gac every assembly gac runs full trust installing smartpart gac easy installation question asked whether want assembly installed gac deploying user controls assembly gac also quite easy assembly strong name course drag drop dll file c windows assembly theres one issue solve youll notice youve deployed user controls assembly gac deleted bin folder course youll get exception unable load seems smartpart look gac load user controls assembly fix last problem need make modifications web config file sharepoint site compilation section need add user controls assembly compilation batch false debug false assemblies add assembly dropdownnavigationvb versionculture neutral publickeytoken 3948f234abe18 assemblies compilation steps may little bit overwhelming lets summarize create example example connect web service fetch weather information ive used web service capescience step install smartpart make sure deploy gac step create new asp net web application contain user control name example weatherinfo add web reference globalweather wsdl name weatherservices example add new web user control project name weatherinfo add label control switch code view type following code page_load method private void page_load object sender system eventargs e weatherservices globalweather gw new weatherservices globalweather label1 text temperature brussels gw getweatherreport ebbr temperature ambient tostring deploy user controls assembly gac need give strong name generate public private key pair specify assemblykeyfileattribute assemblyinfo file detailed information process found additionally change version number specified assemblyinfo file fixed version number e gotherwise every build new version number generated finally build project step deploy user controls assembly deploy weatherinfo dll file gac drag drop c windows assembly directory use gacutil utility weahterinfo ascx file needs copied example usercontrols folder sharepoint site default folder need create step alter web config mentioned need alter web config sharepoint site user controls assembly located gac find compilation section looks like compilation batch false debug false change compilation batch false debug false assemblies add assembly weatherinfo versionculture neutral publickeytoken 6185e98411448c6a assemblies compilation use reflector tool read public key assembly copy paste full assembly name wont make typos step load user control sharepoint finally add smartpart webpart sharepoint site load weatherinfo control set user control property usercontrols weatherinfo ascx click ok button everything went well able see temperature brussels conclude ill repeat one first sentences post security bitch sometimes must think cas good thing even extra steps considered need taken get weatherinfo webpart running still think creating sharepoint webparts help asp net user controls productive approach time im wondering gac deployment step avoided anyone idea download weatherinfo solution gotdotnet workspace next post ill dive easily test drive webparts using smartpart webpart related